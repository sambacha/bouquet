{"version":3,"file":"Settings.js","sourceRoot":"","sources":["../../ts/components/Settings.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Signal, useSignal } from '@preact/signals'\nimport { utils } from 'ethers'\nimport { JSX } from 'preact/jsx-runtime'\nimport { MEV_RELAY_MAINNET } from '../constants.js'\nimport { AppSettings } from '../types/types.js'\nimport { Button } from './Button.js'\n\nexport const SettingsIcon = () => {\n\treturn (\n\t\t<svg\n\t\t\tclass='text-white h-8 w-8'\n\t\t\taria-hidden='true'\n\t\t\tfill='none'\n\t\t\tstroke='currentColor'\n\t\t\tstrokeWidth={1.5}\n\t\t\tviewBox='0 0 24 24'\n\t\t\txmlns='http://www.w3.org/2000/svg'\n\t\t>\n\t\t\t<path\n\t\t\t\td='M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z'\n\t\t\t\tstrokeLinecap='round'\n\t\t\t\tstrokeLinejoin='round'\n\t\t\t/>\n\t\t\t<path d='M15 12a3 3 0 11-6 0 3 3 0 016 0z' strokeLinecap='round' strokeLinejoin='round' />\n\t\t</svg>\n\t)\n}\n\nexport const SettingsModal = ({ display, appSettings }: { display: Signal<boolean>, appSettings: Signal<AppSettings> }) => {\n\tconst editedSettings = useSignal(appSettings.value)\n\tfunction inputRPC(value: string) {\n\t\t// https://urlregex.com/\n\t\tconst matchURL = value.match(/((([A-Za-z]{3,9}:(?:\\/\\/)?)(?:[\\-;:&=\\+\\$,\\w]+@)?[A-Za-z0-9\\.\\-]+|(?:www\\.|[\\-;:&=\\+\\$,\\w]+@)[A-Za-z0-9\\.\\-]+)((?:\\/[\\+~%\\/\\.\\w\\-_]*)?\\??(?:[\\-\\+=&;%@\\.\\w_]*)#?(?:[\\.\\!\\/\\\\\\w]*))?)/g)\n\t\tif (!value || !matchURL || matchURL.length !== 1) return\n\t\teditedSettings.value = { ...editedSettings.peek(), relayEndpoint: value }\n\t}\n\tfunction inputPriorityFee(value: string) {\n\t\tif (!value) return\n\t\ttry {\n\t\t\tconst parsedValue = Number(value);\n\t\t\teditedSettings.value = { ...editedSettings.peek(), priorityFee: utils.parseUnits(String(parsedValue), 'gwei').toBigInt() }\n\t\t} catch {\n\t\t\treturn\n\t\t}\n\t}\n\tfunction inputTargetBlocks(value: string) {\n\t\tif (!value) return\n\t\ttry {\n\t\t\tconst parsedValue = Number(value)\n\t\t\teditedSettings.value = { ...editedSettings.peek(), blocksInFuture: BigInt(parsedValue) }\n\t\t} catch {\n\t\t\treturn\n\t\t}\n\t}\n\tfunction saveSettings() {\n\t\tappSettings.value = editedSettings.value\n\t\tlocalStorage.setItem('bouquetSettings', JSON.stringify({ priorityFee: editedSettings.value.priorityFee.toString(), blocksInFuture: editedSettings.value.blocksInFuture.toString(), relayEndpoint: editedSettings.value.relayEndpoint }))\n\t\tclose()\n\t}\n\tfunction resetSettings() {\n\t\tappSettings.value = { blocksInFuture: 3n, priorityFee: 10n ** 9n * 3n, relayEndpoint: MEV_RELAY_MAINNET };\n\t\tclose()\n\t}\n\tfunction close() {\n\t\teditedSettings.value = appSettings.value\n\t\tdisplay.value = false\n\t}\n\treturn display.value ? (\n\t\t<div onClick={close} class='flex items-center justify-center bg-black/50 h-full fixed inset-0'>\n\t\t\t<div class='h-max w-82 p-4 flex flex-col gap-4 rounded-2xl bg-background' onClick={(e) => e.stopPropagation()}>\n\t\t\t\t<h2 className='text-xl font-semibold'>App Settings</h2>\n\t\t\t\t<div>\n\t\t\t\t\t<h3 className='font-semibold'>MEV Relay URL</h3>\n\t\t\t\t\t<input\n\t\t\t\t\t\tonChange={(e: JSX.TargetedEvent<HTMLInputElement>) => inputRPC(e.currentTarget.value)}\n\t\t\t\t\t\tvalue={editedSettings.value.relayEndpoint} type=\"url\" className=\"p-2 text-lg rounded-xl border-slate-200/70 border-2 bg-background w-full\" />\n\t\t\t\t</div>\n\t\t\t\t<div>\n\t\t\t\t\t<h3 className='font-semibold'>Priority Fee (GWEI)</h3>\n\t\t\t\t\t<input\n\t\t\t\t\t\tonChange={(e: JSX.TargetedEvent<HTMLInputElement>) => inputPriorityFee(e.currentTarget.value)}\n\t\t\t\t\t\tvalue={utils.formatUnits(editedSettings.value.priorityFee, 'gwei')} type=\"number\" className=\"p-2 text-lg rounded-xl border-slate-200/70 border-2 bg-background w-full\" />\n\t\t\t\t</div>\n\t\t\t\t<div>\n\t\t\t\t\t<h3 className='font-semibold'>Target Blocks In Future For Bundle Confirmation</h3>\n\t\t\t\t\t<input\n\t\t\t\t\t\tonChange={(e: JSX.TargetedEvent<HTMLInputElement>) => inputTargetBlocks(e.currentTarget.value)}\n\t\t\t\t\t\tvalue={editedSettings.value.blocksInFuture.toString()} type=\"number\" className=\"p-2 text-lg rounded-xl border-slate-200/70 border-2 bg-background w-full\" />\n\t\t\t\t</div>\n\t\t\t\t<div className='flex gap-2'>\n\t\t\t\t\t<Button onClick={saveSettings} variant='primary'>Save</Button>\n\t\t\t\t\t<Button onClick={resetSettings} variant='secondary'>Reset</Button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t) : null\n}\n"]}